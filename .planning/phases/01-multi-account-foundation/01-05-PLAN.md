---
phase: 01-multi-account-foundation
plan: 05
type: execute
wave: 5
depends_on: ["01-04"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Admin can add multiple Bluesky accounts from settings page with handle and app password"
    - "Each connected account shows current connection status (authenticated, expired, error)"
    - "Admin can remove a connected account with confirmation"
    - "Existing single-account data migrates to multi-account structure without data loss"
    - "User can select which account(s) to syndicate to on a per-post basis in editor"
    - "User can switch which account to display content from (profile cards, feeds)"
    - "When multi-account is disabled, everything works identically to before"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete Phase 1 Multi-Account Foundation works end-to-end by testing all user-facing workflows in the WordPress admin and frontend.

Purpose: Catch integration issues between plans before marking the phase complete. Each plan was verified individually, but end-to-end flow testing reveals gaps in wiring between components.

Output: Verification results — pass/fail for each success criterion.
</objective>

<execution_context>
@/Users/CRG/.claude/get-shit-done/workflows/execute-plan.md
@/Users/CRG/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-multi-account-foundation/01-CONTEXT.md
@.planning/phases/01-multi-account-foundation/01-01-SUMMARY.md
@.planning/phases/01-multi-account-foundation/01-02-SUMMARY.md
@.planning/phases/01-multi-account-foundation/01-03-SUMMARY.md
@.planning/phases/01-multi-account-foundation/01-04-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 1: Verify complete multi-account flow</name>
  <files>classes/BlueSky_Account_Manager.php, classes/BlueSky_Plugin_Setup.php, classes/BlueSky_Post_Metabox.php, classes/BlueSky_Discussion_Display.php</files>
  <action>
This is a human verification checkpoint. Present the following test plan to the user and wait for approval.

**What was built (Plans 01-04):**
- Plan 01: Account Manager with CRUD, migration, feature toggle
- Plan 02: Settings page multi-account UI with progressive disclosure
- Plan 03: Multi-account syndication with per-post account selection
- Plan 04: Async pipeline, cache scoping, discussion display updates

**Test plan for user:**

Pre-check: Ensure plugin loads without errors
1. Navigate to WordPress admin. Verify no PHP errors or warnings.
2. Go to Plugins page. Verify "Social Integration for BlueSky" is active.

Test 1: Single-account mode (multi-account DISABLED)
3. Go to Settings > Bluesky Social Settings.
4. Verify the "Enable Multi-Account" checkbox exists on Account Settings tab.
5. Verify it is UNCHECKED by default.
6. Verify no multi-account UI is visible (no account list, no add account form).
7. Verify existing single-account settings still work (handle, app password).
8. Create a new post, verify the metabox shows the existing "Don't syndicate" checkbox with NO account checkboxes.

Test 2: Enable multi-account and migration
9. Check "Enable Multi-Account" and save settings.
10. The multi-account section should appear.
11. If you had an existing connected account, it should appear in the account list as "Primary Account" with your handle.
12. Verify the existing account shows "Authenticated" status (green).

Test 3: Account management
13. Click "Add Account" and fill in a second Bluesky account (name, handle, app password).
14. Submit. Verify the account appears in the list with correct status.
15. Test "Make Active" button on the second account. Verify the active indicator moves.
16. Test "Remove" on the second account. Verify confirmation dialog appears.
17. Confirm removal. Verify the account is removed from the list.

Test 4: Syndication (requires at least 2 accounts)
18. Re-add the second account.
19. Create a new post in the classic editor.
20. Verify the metabox shows account checkboxes. Accounts with auto-syndicate should be pre-checked.
21. Select both accounts and publish.
22. Verify the post was syndicated (check post meta in database or verify Bluesky posts exist).

Test 5: Discussion thread
23. Navigate to the Discussions tab in Bluesky settings.
24. Verify the "Discussion Thread Source" dropdown appears with your connected accounts.
25. Select an account.
26. View the syndicated post on the frontend. Verify discussion thread loads from the selected account.

Test 6: Cache scoping
27. Add a Bluesky profile card block or shortcode to a page.
28. View the page. Verify it shows data from the active account.
29. Switch active account in settings.
30. Refresh the page. Verify profile card now shows the NEW active account's data (not cached old data).

Test 7: Disable multi-account
31. Uncheck "Enable Multi-Account" and save.
32. Verify multi-account UI disappears.
33. Verify single-account functionality still works.

Resume signal: Type "approved" if all tests pass, or describe any issues found.
  </action>
  <verify>User confirms all 7 test groups pass by typing "approved".</verify>
  <done>All Phase 1 success criteria verified end-to-end by human testing. Multi-account foundation is complete.</done>
</task>

</tasks>

<verification>
This plan IS the verification — the human-verify checkpoint tests all Phase 1 success criteria end-to-end.
</verification>

<success_criteria>
All Phase 1 success criteria verified:
1. Admin can add multiple Bluesky accounts from settings page
2. Each connected account shows connection status
3. Admin can remove a connected account with confirmation
4. Existing single-account data migrates without data loss
5. User can select which account(s) to syndicate to per-post
6. User can switch which account to display content from
7. Multi-account is opt-in (disabled by default)
8. Auto-syndication toggle works per account
9. Discussion thread uses configurable account
</success_criteria>

<output>
After completion, create `.planning/phases/01-multi-account-foundation/01-05-SUMMARY.md`
</output>
